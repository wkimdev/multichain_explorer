<!DOCTYPE html>
<html>
<head>
    <title>Hello WebSocket</title>
<!--     <link href="/webjars/bootstrap/css/bootstrap.min.css" rel="stylesheet"> -->
<!--     <link href="/main.css" rel="stylesheet"> -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.5/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script>

$(function () {
	connect();
});


var stompClient = null;
 
function connect() {
    var socket = new SockJS('/ws'); //소켓 연결
    stompClient = Stomp.over(socket);
    stompClient.connect({}, function (frame) {
        console.log('Connected: ' + frame);
        stompClient.subscribe('/subscribe/broadcast', function (message) { //브로드캐스하는 저 채널을 구독한다. 그리고 callback 값을 받는다.  
        	console.log(JSON.parse(message.body));
        });
    });
}

// 서버와의 소켓 연결을 끊는다.
function disconnect() {
	if(stompClient != null) {
        stompClient.disconnect();
 	   console.log("Disconnected");
    }
}
</script>
</head>
<body>
	test
</body>
</html>
